---
phase: 05-performance
plan: 02
type: execute
wave: 1
depends_on: [05-01]
files_modified: [index.html]
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "Google Fonts CSS loads without blocking render"
    - "Lighthouse reports 0 render-blocking resources"
    - "LCP improves by ~170ms (font blocking eliminated)"
  artifacts:
    - path: "index.html"
      provides: "Async font loading"
      contains: "media=\"print\" onload"
  key_links:
    - from: "index.html:121"
      to: "fonts.googleapis.com"
      via: "non-blocking stylesheet load"
      pattern: "media=\"print\".*onload.*rel='stylesheet'"
---

<objective>
Convert Google Fonts from render-blocking to async loading

Purpose: Close 2 UAT gaps (LCP 3.1s->target 2.5s, render-blocking warning) by making Google Fonts CSS non-blocking
Output: Modified index.html with async font loading strategy
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-performance/05-01-SUMMARY.md
@.planning/phases/05-performance/05-UAT.md
@.planning/debug/lcp-performance-issue.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Convert Google Fonts to async loading</name>
  <files>index.html (line 121)</files>
  <action>
Replace the render-blocking Google Fonts stylesheet at line 121:

CURRENT (line 121):
```html
<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&family=Source+Serif+4:opsz,wght@8..60,400;8..60,500;8..60,600&display=swap" rel="stylesheet">
```

REPLACE WITH (media="print" trick for async loading):
```html
<link rel="preload" href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&family=Source+Serif+4:opsz,wght@8..60,400;8..60,500;8..60,600&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&family=Source+Serif+4:opsz,wght@8..60,400;8..60,500;8..60,600&display=swap"></noscript>
```

How this works:
1. `rel="preload" as="style"` - Browser fetches CSS but doesn't block render
2. `onload="this.onload=null;this.rel='stylesheet'"` - When loaded, activates as stylesheet
3. `this.onload=null` - Prevents onload firing twice in some browsers
4. `<noscript>` fallback - Users without JS still get fonts

Keep existing preconnect hints at lines 118-119 (they're still valuable for connection warmup).

Do NOT remove `display=swap` from the URL - it ensures text remains visible during font load.
  </action>
  <verify>
1. Grep for "media=\"print\"" or "rel=\"preload\"" with "as=\"style\"" in index.html
2. Confirm no standard `rel="stylesheet"` for fonts.googleapis.com (except in noscript)
3. Visual check: Page loads, fonts eventually apply (may flash system font briefly - expected FOUT)
  </verify>
  <done>
- index.html line 121 uses preload+onload pattern (not blocking rel="stylesheet")
- noscript fallback present for no-JS users
- Existing preconnect hints unchanged
  </done>
</task>

</tasks>

<verification>
Run these checks after task completion:

1. **Grep for blocking font stylesheet (should find 0 outside noscript):**
   ```bash
   grep -n "fonts.googleapis.com.*rel=\"stylesheet\"" index.html | grep -v noscript
   ```
   Expected: No output (all stylesheet refs are in noscript)

2. **Grep for async pattern (should find 1):**
   ```bash
   grep -n "preload.*fonts.googleapis.com\|fonts.googleapis.com.*preload" index.html
   ```
   Expected: Line 121 with preload pattern

3. **Visual verification:**
   - Open index.html in browser
   - Page should load immediately (no font blocking)
   - Fonts should apply shortly after (may see brief FOUT - this is correct behavior)

4. **Lighthouse re-test (user performs):**
   - "Eliminate render-blocking resources" should show 0 or not appear
   - LCP should improve (target: under 2.5s)
</verification>

<success_criteria>
1. Google Fonts CSS no longer blocks render (preload pattern in place)
2. Fonts still load and apply correctly (visual check)
3. noscript fallback ensures accessibility for no-JS users
4. Ready for UAT re-verification to confirm LCP improvement
</success_criteria>

<output>
After completion, create `.planning/phases/05-performance/05-02-SUMMARY.md`
</output>
